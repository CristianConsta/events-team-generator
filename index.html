<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desert Storm - Team Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Rajdhani:wght@400;600;700&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Rajdhani', sans-serif;
            background: #1A1A2E;
            color: #FFFFFF;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 3rem;
            background: linear-gradient(135deg, #FF6B35, #F7931E, #FDC830);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            margin-bottom: 40px;
        }
        
        .upload-section {
            background: #16213E;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            border: 2px solid rgba(253, 200, 48, 0.3);
        }
        
        .upload-area {
            border: 3px dashed #FDC830;
            border-radius: 15px;
            padding: 50px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .upload-area:hover {
            background: rgba(253, 200, 48, 0.1);
            transform: scale(1.02);
        }
        
        .upload-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: #FDC830;
            margin-bottom: 10px;
        }
        
        input[type="file"] { display: none; }
        
        .processing {
            display: none;
            text-align: center;
            padding: 30px;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(253, 200, 48, 0.2);
            border-top-color: #FDC830;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .results {
            display: none;
        }
        
        .result-card {
            background: #16213E;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            border: 2px solid rgba(255, 107, 53, 0.3);
        }
        
        .result-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #FDC830;
            margin-bottom: 15px;
        }
        
        .download-btn {
            background: linear-gradient(135deg, #FF6B35, #F7931E);
            color: #FFFFFF;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }
        
        .download-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.6);
        }
        
        .info-section {
            background: rgba(22, 33, 62, 0.6);
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            border-left: 5px solid #FDC830;
        }
        
        .info-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #FDC830;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèúÔ∏è Desert Storm üèúÔ∏è</h1>
        
        <div class="upload-section">
            <div class="upload-area" id="uploadArea">
                <div class="upload-text">üì§ Upload Your Player Excel File</div>
                <p style="opacity: 0.7;">Click or drag & drop UBS_players.xlsx here</p>
                <input type="file" id="fileInput" accept=".xlsx,.xls">
            </div>
        </div>
        
        <div class="processing" id="processing">
            <div class="spinner"></div>
            <p style="font-size: 1.3rem; color: #FDC830;">Processing assignments and generating infographics with map...</p>
        </div>
        
        <div class="results" id="results">
            <div class="result-card">
                <div class="result-title">üìä Team Assignments Excel</div>
                <p style="margin-bottom: 20px;">Complete player assignments for both teams</p>
                <button class="download-btn" id="downloadExcel">‚¨áÔ∏è Download Excel</button>
            </div>
            
            <div class="result-card">
                <div class="result-title">üì± Team A Infographic (with Map)</div>
                <p style="margin-bottom: 20px;">Professional assignment sheet with battlefield map</p>
                <button class="download-btn" id="downloadTeamA">‚¨áÔ∏è Download Team A</button>
            </div>
            
            <div class="result-card">
                <div class="result-title">üì± Team B Infographic (with Map)</div>
                <p style="margin-bottom: 20px;">Professional assignment sheet with battlefield map</p>
                <button class="download-btn" id="downloadTeamB">‚¨áÔ∏è Download Team B</button>
            </div>
        </div>
        
        <div class="info-section">
            <div class="info-title">‚ÑπÔ∏è How It Works</div>
            <p>1. Upload your Excel file with player data</p>
            <p>2. Mark "Y" in Desert Storm columns (J for Team A, L for Team B)</p>
            <p>3. Get assignments + infographics with battlefield map!</p>
        </div>
    </div>

    <script>
        let teamAAssignments = [];
        let teamBAssignments = [];
        let mapImage = null;
        
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const processing = document.getElementById('processing');
        const results = document.getElementById('results');
        
        // Preload map image
        mapImage = new Image();
        mapImage.src = 'data:image/jpeg;base64,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